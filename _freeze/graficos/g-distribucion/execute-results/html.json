{
  "hash": "d0d588c65d3b6e6d906c72f7cd166632",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Distribuciones\"\nsubtitle: \"Gráficos de barras, histogramas, cajas y violines\"\n---\n\n\n\n\n\n\n## Barras - var. categóricas\n\nEl comando básico el `geom_bar()`. Dentro del `aes` se incluye únicamente la variable (categórica) x, ya que lo que este gráfico permite ver la frecuencia de cada categoría de una variable.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npenguins %>% \n  ggplot(aes(x = species)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](g-distribucion_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n\n### Modificaciones\n\n#### Añadir color a los bordes\n\nEl color se especifica en `color`.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_bar(aes(x = species), \n           color = \"red\")\n```\n\n::: {.cell-output-display}\n![](g-distribucion_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n\n#### Añadir color al relleno\n\nEl color se especifica en `fill`.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_bar(aes(x = species), \n           fill = \"red\")\n```\n\n::: {.cell-output-display}\n![](g-distribucion_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n\n**Se pueden usar ambos a la vez**\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_bar(aes(x = species), \n           color = \"black\",\n           fill = \"red\")\n```\n\n::: {.cell-output-display}\n![](g-distribucion_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n\n#### Añadir transparencia al relleno\n\nSe usa `alpha`.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_bar(aes(x = species), \n           color = \"black\",\n           fill = \"red\",\n           alpha = 0.7)\n```\n\n::: {.cell-output-display}\n![](g-distribucion_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n\n#### Modificar el tamaño del borde\n\nCon `linewidth`:\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_bar(aes(x = species), \n           color = \"black\",\n           fill = \"red\",\n           alpha = 0.7,\n           linewidth = 0.2)\n```\n\n::: {.cell-output-display}\n![](g-distribucion_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n\n## Histogramas - var. numérica\n\nEl comando básico el `geom_histogram()`. Dentro del `aes` se incluye únicamente la variable (numérica) x, ya que lo que este gráfico permite ver la distribución de la frecuencia de una variable.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npenguins %>% \n  ggplot(aes(x = bill_length_mm)) +\n  geom_histogram()\n```\n\n::: {.cell-output-display}\n![](g-distribucion_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n\n### Modificaciones\n\n#### Estéticas\n\nLas mismas que en los gráficos de barras (relleno, transparencia, tamaño y color del borde...)\n\n#### Elegir el número de columnas\n\nSe emplea la opción `binwidth`, que establece las unidades mostradas en cada barra. Por tanto, si binwidth = 2, dividirá la barra de dos en dos unidades, mientras que si es igual a 10 cada barra agrupará 10 cifras. Es decir, a mayor tamaño de binwidth, menor número de barras.\n\n::: {layout-ncol=\"2\"}\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npenguins %>% \n  ggplot(aes(x = bill_length_mm)) +\n  geom_histogram(binwidth = 2)\n```\n\n::: {.cell-output-display}\n![binwidth = 2](g-distribucion_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=60%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npenguins %>% \n  ggplot(aes(x = bill_length_mm)) +\n  geom_histogram(binwidth = 4)\n```\n\n::: {.cell-output-display}\n![binwidth = 4](g-distribucion_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n:::\n\n## Densidades - var. numéricas\n\nEl comando básico el `geom_density()`. Dentro del `aes` se incluye únicamente la variable (numérica) x, ya que lo que este gráfico permite ver la distribución de la frecuencia de una variable.\n\nEs un gráfico muy similar al histograma, pero en lugar de mostrar la frecuencia mediante barras lo hace a partir de una línea continua.\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(penguins) +\n  geom_density(aes(x = bill_length_mm))\n```\n\n::: {.cell-output-display}\n![](g-distribucion_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n\n### Dividir el gráfico en función de una variable categórica\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\npenguins %>% \n  ggplot() +\n  geom_density(aes(x = bill_length_mm,\n                   group = species,\n                   color = species))\n```\n\n::: {.cell-output-display}\n![](g-distribucion_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=60%}\n:::\n:::\n\n\n\n\n## Ejemplos\n\n#### Barras divididas según una tercera variable\n\n**Distribución ideológica de los votantes según el partido**\n\n::: panel-tabset\n### Gráfico\n\n![](01_img/barras_dobles_ideol.png){.zoomable fig-align=\"center\" width=\"500\"}\n\n### Código\n\n``` r\nggplot(datos, aes(x = ideol, y = freq, fill = partido)) +\n  geom_hline(yintercept = c(0, 5, 10, 15, 20, 25), color = \"lightgrey\", alpha = 0.5) +\n  geom_bar(stat = \"identity\", position = \"dodge\", alpha=0.8) +\n  theme_classic() +\n  labs(x = \"Posición ideológica (0-10)\",\n       y = \"Porcentaje de votantes\",\n       caption = \"Distribución en la escala ideológica de los votantes del PP y PSOE\\nFuente: elaboración propia a partir de los datos de 40db\") +\n  geom_text(aes(label = paste0(round(freq, 1), \"%\")), position = position_dodge(width = 0.9), vjust = -0.5, size = 3)+\n  scale_fill_manual(values=c(\"PP\"=\"#17589d\", \"PSOE\"=\"#FF1C1C\"))+\n  theme(\n        legend.position = \"bottom\",\n        legend.title = element_blank(), \n        legend.text = element_text(size = 9),\n        axis.title = element_text(size = 10))\n```\n\n### Código anotado\n\n``` r\nggplot(datos, aes(x = ideol, y = freq, fill = partido)) +\n\n## Línes de fondo para indicar los valores del eje y\n  geom_hline(yintercept = c(0, 5, 10, 15, 20, 25), color = \"lightgrey\", alpha = 0.5) +\n  \n## Las barras\n  geom_bar(stat = \"identity\", position = \"dodge\",\n           alpha=0.8) + # Alpha indica la transparencia de las barras (cuanto menor es el número, más transparentes)\n\n## Ajustes estéticos\n  theme_classic() + # Tema del fondo (en blanco)\n  labs(x = \"Posición ideológica (0-10)\", # Etiqueta eje x\n       y = \"Porcentaje de votantes\", # Etiqueta eje y\n       caption = \"Distribución en la escala ideológica de los votantes del PP y PSOE\\nFuente: elaboración propia a partir de los datos de 40db\") + # Texto a pie de gráfico. El \\n indica que se pasa a otra línea.\n  geom_text(aes(label = paste0(round(freq, 1), \"%\")), position = position_dodge(width = 0.9), vjust = -0.5, size = 3)+ # Los números del % encima de las barras\n  scale_fill_manual(values=c(\"PP\"=\"#17589d\", \"PSOE\"=\"#FF1C1C\"))+ # Color del relleno\n  theme( #Ajustes del tamaño y posición de los títulos\n        legend.position = \"bottom\",\n        legend.title = element_blank(), \n        legend.text = element_text(size = 9),\n        axis.title = element_text(size = 10))\n```\n:::\n\n**Pertenencia a una generación u otra según el género**\n\n::: panel-tabset\n### Gráfico\n\n![](01_img/barras_dobles.png){.zoomable fig-align=\"center\" width=\"500\"}\n\n### Código\n\n``` r\nggplot(brecha_gen, aes(x = gen, y = porcentaje, fill = genero)) +\n  scale_y_continuous(limits=c(0,30))+\n  geom_hline(yintercept = c(0, 10, 20,30), color = \"lightgrey\", alpha = 0.5) +\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.94), width = 0.87, colour=\"black\") +\n  labs(x = \"Generación\", y = \"Porcentaje de manifestantes\", fill = \"Género\", caption = \"Figura 3: Porcentaje de manifestantes en cada generación según su género\") +\n  theme_classic() +\n  geom_text(aes(label = porcentaje, y = porcentaje + 1),\n            position = position_dodge(width = 1), vjust = 1.1, size = 3) +\n  theme(plot.caption = element_text(hjust=0,family=\"Times New Roman\",size=15), #Ajustes del caption\n        text = element_text(size = 11),  # Tamaño del texto del gráfico\n        legend.position = \"bottom\",      # Posición de la leyenda\n        legend.title = element_blank(),   # Elimina el título de la leyenda\n        legend.text = element_text(size = 9),  # Tamaño del texto de la leyenda\n        axis.title = element_text(size = 12)) +  # Tamaño del texto de los títulos de los ejes\n  scale_fill_manual(values=c(\"Hombre\"=\"#d8d8d8\", \"Mujer\"=\"#777777\"))\n```\n\n### Código anotado\n\n``` r\nggplot(brecha_gen, aes(x = gen, y = porcentaje, fill = genero)) +\n\n## Ajustes del eje y: limites y líneas grises del fondo\n  scale_y_continuous(limits=c(0,30))+\n  geom_hline(yintercept = c(0, 10, 20,30), color = \"lightgrey\", alpha = 0.5) +\n\n## El gráfico de barras\n  geom_bar(stat = \"identity\", position = position_dodge(width = 0.94), width = 0.87, colour=\"black\") +\n\n## Otros ajustes estéticos (iguales que en el gráfico anterior)\n  labs(x = \"Generación\", y = \"Porcentaje de manifestantes\", fill = \"Género\", caption = \"Figura 3: Porcentaje de manifestantes en cada generación según su género\") +\n  theme_classic() +\n  geom_text(aes(label = porcentaje, y = porcentaje + 1),\n            position = position_dodge(width = 1), vjust = 1.1, size = 3) +\n  theme(plot.caption = element_text(hjust=0,family=\"Times New Roman\",size=15), #Ajustes del caption\n        text = element_text(size = 11),  # Tamaño del texto del gráfico\n        legend.position = \"bottom\",      # Posición de la leyenda\n        legend.title = element_blank(),   # Elimina el título de la leyenda\n        legend.text = element_text(size = 9),  # Tamaño del texto de la leyenda\n        axis.title = element_text(size = 12)) +  # Tamaño del texto de los títulos de los ejes\n  scale_fill_manual(values=c(\"Hombre\"=\"#d8d8d8\", \"Mujer\"=\"#777777\"))\n```\n:::\n\n#### Barras divididas para 4 categorías\n\n::: panel-tabset\n### Gráfico\n\n![](01_img/barras_4_difer_posicion.png){.zoomable fig-align=\"center\" width=\"500\"}\n\n### Código\n\n``` r\nggplot(diferencias_dcha, aes(x = Tema, y = diferencias, fill = Partido)) +\n  geom_hline(yintercept = seq(0,5,by=0.5), color = \"lightgrey\", alpha = 0.3) +\n  geom_bar(stat = \"identity\", position = \"dodge\", alpha=0.8) +\n  theme_classic() +\n  labs(x = NULL,\n       y = \"Diferencia (0-10)\",\n       caption = \"Distancia entre el Vox y PP y los votantes de derechas y centro.\\nLa distancia se ha medido como la resta de la media del partido menos la del grupo ideológico (términos absolutos).\",\n       fill=\"Partido-ideología:\") +\n  geom_text(aes(label = round(diferencias, 2)), position = position_dodge(width = 0.9), vjust = -0.5, size = 3)+\n  theme(legend.position = \"bottom\",\n        legend.text = element_text(size = 9),\n        axis.title = element_text(size = 12))+\n  scale_fill_manual(\n    values = c(\"PP_c\"=\"#85B9ED\",\"PP_d\"=\"#17589d\",\"Vox_c\"=\"#B3E384\",\"Vox_d\"=\"#63ac33\"),\n    labels = c(\"PP_c\" = \"PP (centro)\",\"PP_d\" = \"PP (derecha)\",\"Vox_c\" = \"Vox (centro)\",\"Vox_d\" = \"Vox (derecha)\"))+\n  scale_x_discrete(labels=c(\"Inversión contra\\n Cambio Climático\",  \"Servicios Públicos\\n vs. Impuesto Bajos\", \"Inmigración\", \"Derechos LGTBI\\n (adopción)\", \"Descentralización\\n Territorial\"))\n```\n\n### Código anotado\n\n``` r\nggplot(diferencias_dcha, aes(x = Tema, y = diferencias, fill = Partido)) +\n\n## Ajustes del eje y: líneas grises del fondo\n  geom_hline(yintercept = seq(0,5,by=0.5), color = \"lightgrey\", alpha = 0.3) +\n\n## El gráfico de barras\n  geom_bar(stat = \"identity\", position = \"dodge\", alpha=0.8) +\n\n## Otros ajustes estéticos (iguales que en el primer gráfico)\n  theme_classic() +\n  labs(x = NULL,\n       y = \"Diferencia (0-10)\",\n       caption = \"Distancia entre el Vox y PP y los votantes de derechas y centro.\\nLa distancia se ha medido como la resta de la media del partido menos la del grupo ideológico (términos absolutos).\",\n       fill=\"Partido-ideología:\") +\n  geom_text(aes(label = round(diferencias, 2)), position = position_dodge(width = 0.9), vjust = -0.5, size = 3)+\n  theme(legend.position = \"bottom\",\n        legend.text = element_text(size = 9),\n        axis.title = element_text(size = 12))+\n  scale_fill_manual(\n    values = c(\"PP_c\"=\"#85B9ED\",\"PP_d\"=\"#17589d\",\"Vox_c\"=\"#B3E384\",\"Vox_d\"=\"#63ac33\"),\n    labels = c(\"PP_c\" = \"PP (centro)\",\"PP_d\" = \"PP (derecha)\",\"Vox_c\" = \"Vox (centro)\",\"Vox_d\" = \"Vox (derecha)\"))+\n\n## Para cambiar las etiquetas del eje x\n  scale_x_discrete(labels=c(\"Inversión contra\\n Cambio Climático\",  \"Servicios Públicos\\n vs. Impuesto Bajos\", \"Inmigración\", \"Derechos LGTBI\\n (adopción)\", \"Descentralización\\n Territorial\"))\n```\n\n### Formato de los datos\n\n![](images/clipboard-288138357.png){.zoomable fig-align=\"center\" width=\"200\"}\n:::\n",
    "supporting": [
      "g-distribucion_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}