<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lineal simple – Página R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../analisis/reg-multiple.html" rel="next">
<link href="../analisis/tablas-contingencia.html" rel="prev">
<link href="../01_img/icono.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<style>
/* Estilos para todo el documento */
body {
  text-align: justify;
}
/* Estilos específicos para la tabla de contenidos */
.toc-actions, .toc .nav, .toc .nav > li > a {
  text-align: left !important;
}
</style>
<script>
// Añadir funcionalidad de zoom para imágenes
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('img.zoomable').forEach(function(img) {
    img.addEventListener('click', function() {
      this.classList.toggle('zoomed');
    });
  });
});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Página R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Introducción a R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../dg-var/ficheros-datos.qmd"> 
<span class="menu-text">Bases de datos y variables</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../descriptivo.qmd"> 
<span class="menu-text">Análisis de datos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../graficos/g-intro.html"> 
<span class="menu-text">Gráficos</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../otros.html"> 
<span class="menu-text">Otros</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <a class="flex-grow-1 no-decor" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
          <h1 class="quarto-secondary-nav-title">Lineal simple</h1>
        </a>     
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analisis/descriptivo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Análisis descriptivo</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Análisis bivariado</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analisis/teoria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Teoría</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analisis/ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">T-test</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analisis/correlacion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Análisis de correlación</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analisis/tablas-contingencia.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Tablas de contingencia</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Regresiones</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analisis/reg-lineal.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Lineal simple</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analisis/reg-multiple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lineal múltiple</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">analisis/predicciones.qmd</span>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analisis/reg-logistica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regresión logística</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenido</h2>
   
  <ul>
  <li><a href="#en-r" id="toc-en-r" class="nav-link active" data-scroll-target="#en-r">En R</a>
  <ul class="collapse">
  <li><a href="#resumen-de-las-funciones-principales" id="toc-resumen-de-las-funciones-principales" class="nav-link" data-scroll-target="#resumen-de-las-funciones-principales">Resumen de las funciones principales</a></li>
  <li><a href="#preliminar" id="toc-preliminar" class="nav-link" data-scroll-target="#preliminar">Análisis preliminar</a></li>
  <li><a href="#modelo" id="toc-modelo" class="nav-link" data-scroll-target="#modelo">El modelo de regresión</a></li>
  <li><a href="#resultados" id="toc-resultados" class="nav-link" data-scroll-target="#resultados">Resultados de la regresión</a></li>
  <li><a href="#supuestos" id="toc-supuestos" class="nav-link" data-scroll-target="#supuestos">Diagnóstico de la regresión (supuestos)</a></li>
  <li><a href="#exportar-resultados" id="toc-exportar-resultados" class="nav-link" data-scroll-target="#exportar-resultados">Exportar los resultados</a></li>
  </ul></li>
  <li><a href="#teoría" id="toc-teoría" class="nav-link" data-scroll-target="#teoría">Teoría</a>
  <ul class="collapse">
  <li><a href="#objetivos" id="toc-objetivos" class="nav-link" data-scroll-target="#objetivos">Objetivos:</a></li>
  <li><a href="#regresión-lineal-simple" id="toc-regresión-lineal-simple" class="nav-link" data-scroll-target="#regresión-lineal-simple">Regresión lineal simple</a></li>
  <li><a href="#mínimos-cuadrados-ordinarios-mco" id="toc-mínimos-cuadrados-ordinarios-mco" class="nav-link" data-scroll-target="#mínimos-cuadrados-ordinarios-mco">Mínimos Cuadrados Ordinarios (MCO)</a></li>
  <li><a href="#bondad-de-ajuste-del-modelo" id="toc-bondad-de-ajuste-del-modelo" class="nav-link" data-scroll-target="#bondad-de-ajuste-del-modelo">Bondad de ajuste del modelo</a></li>
  <li><a href="#supuestos-de-la-regresión" id="toc-supuestos-de-la-regresión" class="nav-link" data-scroll-target="#supuestos-de-la-regresión">Supuestos de la regresión</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Lineal simple</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="en-r" class="level2">
<h2 class="anchored" data-anchor-id="en-r">En R</h2>
<p>La regresión lineal se usa para predecir el valor de una variable <strong>y</strong> en función de una o más variables <strong>x</strong>. La variable dependiente debe ser numérica, y las independientes pueden ser tanto numéricas como categóricas. <em>En el ejemplo usado, se tratará de comprobar si el Índice de Corrupción de un país (y) depende del nivel de PIB de este (x).</em></p>
<section id="resumen-de-las-funciones-principales" class="level3">
<h3 class="anchored" data-anchor-id="resumen-de-las-funciones-principales">Resumen de las funciones principales</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis preliminar:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter.smooth</span>(<span class="at">x=</span>datos_reg<span class="sc">$</span>var1, <span class="at">y=</span>datos_reg<span class="sc">$</span>var2) <span class="co">#Gráfico de dispersión</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(datos_reg<span class="sc">$</span>var1, <span class="at">sub=</span><span class="fu">paste</span>(<span class="st">"Outlier rows:  "</span>, <span class="fu">boxplot.stats</span>(datos_reg<span class="sc">$</span>var1)<span class="sc">$</span>out)) <span class="co">#Boxplot para buscar datos atípicos</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_reg, <span class="fu">aes</span>(var1)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">fill=</span><span class="st">"red"</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="co">#Diagrama de densidad (librería ggplot)</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Función de la regresión</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>regresión <span class="ot">&lt;-</span> <span class="fu">lm</span>(var1<span class="sc">~</span>var2, datos_reg) <span class="co">#Librería e1071</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(regresión)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Comprobación de los supuestos principales</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(regresión,<span class="dv">2</span>) <span class="co">#Normalidad de los residuos</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(regresión) <span class="co">#Homocedasticidad (librería lmtest)</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(regresión) <span class="co">#Multicolinealidad (librería rms)</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Exportar los resultados</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(regresión, <span class="at">type=</span><span class="st">"text"</span>) <span class="co">#Librería stargazer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="preliminar" class="level3">
<h3 class="anchored" data-anchor-id="preliminar">Análisis preliminar</h3>
<p>Antes de estimar la regresión, es importante explorar y entender la variable dependiente (fenómeno que queremos explicar).</p>
<ol type="1">
<li><strong>Gráfico de dispersión</strong>: permite visualizar la relación lineal entre la variable independiente y la dependiente. (Es una línea de tendencia, no un gráfico de dispersión, por eso la línea no es recta)</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">scatter.smooth</span>(<span class="at">x=</span>datos_reg<span class="sc">$</span>gdp, <span class="at">y=</span>datos_reg<span class="sc">$</span>cpi, <span class="at">main=</span><span class="st">"GDP ~ CPI"</span>, <span class="at">xlab=</span><span class="st">"GDP"</span>, <span class="at">ylab=</span><span class="st">"CPI"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="reg-lineal_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Boxplot</strong>: permite detectar la presencia de observaciones atípicas (outliers). Los valores atípicos pueden afectar a la predicción, modificando la dirección/pendiente de la recta de regresión.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(datos_reg<span class="sc">$</span>gdp, <span class="at">main=</span><span class="st">"GDP"</span>, <span class="at">sub=</span><span class="fu">paste</span>(<span class="st">"Outlier rows:  "</span>, <span class="fu">boxplot.stats</span>(datos_reg<span class="sc">$</span>gdp)<span class="sc">$</span>out)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="reg-lineal_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Si se quiere comprobar con qué caso se corresponden los valores atípicos detectados se puede usar el siguiente comando:</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionamos el nombre del país cuyo GDP es igual a 30491.34375</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>outlier_gdp <span class="ot">&lt;-</span> datos_reg <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(gdp <span class="sc">==</span> <span class="fl">30491.34375</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(cname)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(outlier_gdp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>outlier_gdp
United States 
            1 </code></pre>
</div>
</div>
<ol start="3" type="1">
<li><strong>Diagrama de densidad</strong>: para ver la distribución de la variable. Idealmente, la distribución ha de ser cercana a la normal. Si esto no ocurre, será necesario realizar alguna transformación en los datos empleados.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos_reg, <span class="fu">aes</span>(cpi)) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="at">fill=</span><span class="st">"red"</span>, <span class="at">alpha=</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="reg-lineal_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="modelo" class="level3">
<h3 class="anchored" data-anchor-id="modelo">El modelo de regresión</h3>
<p>La función utilizada para construir modelos lineales es <code>lm()</code> del paquete <code>e1071</code>, que toma dos argumentos principales: <code>lm(var_dependiente ~ var_independiente, datos)</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>reg.lineal <span class="ot">&lt;-</span> <span class="fu">lm</span>(cpi<span class="sc">~</span>gdp, <span class="at">data=</span>datos_reg) <span class="co">#El argumento "data=" se puede omitir, basta con poner la base de datos. Es decir, se puede escribir directamente: lm(cpi~gdp, datos_reg)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>reg.lineal <span class="co">#Conviene guardar las regresiones dentro de un objeto, ya que de otra forma no se podrían realizar los pasos posteriores.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = cpi ~ gdp, data = datos_reg)

Coefficients:
(Intercept)          gdp  
  24.237839     0.002163  </code></pre>
</div>
</div>
</section>
<section id="resultados" class="level3">
<h3 class="anchored" data-anchor-id="resultados">Resultados de la regresión</h3>
<p>Para evaluar los resultados, imprimimos las estadísticas de resumen para el modelo:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg.lineal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = cpi ~ gdp, data = datos_reg)

Residuals:
     Min       1Q   Median       3Q      Max 
-25.5964  -5.0369   0.3185   6.4699  25.9107 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 2.424e+01  1.521e+00   15.94   &lt;2e-16 ***
gdp         2.163e-03  1.205e-04   17.95   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 10.22 on 108 degrees of freedom
  (84 observations deleted due to missingness)
Multiple R-squared:  0.749, Adjusted R-squared:  0.7467 
F-statistic: 322.3 on 1 and 108 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ul>
<li>Los <strong>coeficientes</strong> indican la contribución de cada variable independiente al modelo de regresión.
<ul>
<li><strong>Intercept</strong>(β<sub>0</sub>). Establece el valor de la variable y cuando la varible x es 0 (el punto donde la recta de regresión corta la ordenada en el orígen). En el <em>ejemplo</em>, el intercepto (β0)= 24.237, lo que significa que, para un país con GDP=0, el valor de su cpi sería 24.237.</li>
<li>El <em>coeficiente</em> de la variable independiente: establece el incremento promedio que experimentará la variable dependiente (y) por cada unidad que se incremetne la variable independiente (x). En el ejemplo, el coeficiente del gdp (β1)=0.002163, lo que significa que por cada incremento de un dolar en el gdp de un país, el cpi aumenta en 0.002163 puntos.</li>
</ul></li>
<li>La evaluación de la <strong>significatividad</strong> de los coeficientes (βi) comienza con la definición de hipótesis sobre los valores de los parámetros poblacionales:
<ul>
<li>Hipótesis nula: H0: βi=0 (el valor del coeficiente en la población es 0).</li>
<li>Hipótesis alternativa: H1: βi≠0 (el valor del coeficiente en la población es distinto de 0).</li>
<li>En el summario de la regresión, se puede comprobar observando el valor de la columna con <em>t value</em> (muestra la prueba t asociada a cada β<sub>i</sub>) o el <em>p-valor</em> de la columna Pr (&gt; | t |).</li>
</ul></li>
<li>La <strong>bondad de ajuste</strong> del modelo (R<sup>2</sup>) mide el porcentaje de varianza de la variable dependiente (Y) que queda explicado con nuestro modelo. Varía entre 0 y 1, y puede interpretarse como un porcentaje. Sin embargo, a medida que agregamos nuevas variables al modelo, el valor R-Squared será mayor. <em>Adj R-Squared</em> penaliza por el número de parámetros en el modelo. Por lo tanto, al comparar modelos anidados, es una buena práctica observar el valor de R<sup>2</sup> ajustado sobre R<sup>2</sup>. <em>En el ejemplo, podemos decir que un 74,67% de la variación en el índice de corrupción se puede explicar gracias a las diferencias en el PIB</em>.</li>
<li>La <strong>significatividad del modelo</strong> (F de Snedecor). Un F estadísticamente significativo significa que al menos uno de los coficientes es estadísticamente significativo. Es decir, que nuestro modelo predice mejor que un modelo sin variables.</li>
</ul>
</section>
<section id="supuestos" class="level3">
<h3 class="anchored" data-anchor-id="supuestos">Diagnóstico de la regresión (supuestos)</h3>
<ol type="1">
<li><strong>Linealidad</strong>. El supuesto de linealidad puede ser comprobada con un gráfico de Residuos vs Valores Predichos.La línea horizontal, sin patrones distintivos en los puntos, indica una relación lineal.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg.lineal, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="reg-lineal_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="1">
<li><strong>Normalidad de los residuos</strong>.</li>
</ol>
<!-- -->
<ol type="i">
<li>El gráfico QQ de residuos puede usarse para comprobar visualmente el supuesto de normalidad. En este gráfico, los residuos debería seguir aproximadamente una línea recta.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg.lineal, <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="reg-lineal_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="i">
<li>Cuando la visualización no es clara y tenemos dudas, podemos hacer un test. Por ejemplo, el de Shapiro-Wilk. La Ho en este test es que los residuos están normalmente distribuidos (lo que queremos). El problema de este test es que está limitado a bases de datos con n menor a 5000 casos. Los resultados confirman que no podemos rechazarla.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>norm<span class="ot">=</span><span class="fu">rstudent</span>(reg.lineal)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(norm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  norm
W = 0.98446, p-value = 0.2316</code></pre>
</div>
</div>
<p>Usando estos mismos datos, también se puede comprobar que la media de los residuos es igual a 0, lo que se calcula gracias a la media. Idealmente, debemos encontrar un valor muy próximo a cero.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(reg.lineal<span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.959911e-16</code></pre>
</div>
</div>
<ol start="3" type="i">
<li>Histograma de los residuos.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(reg.lineal<span class="sc">$</span>residuals, <span class="at">freq =</span> F)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Para superponer la curva normal</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">mean</span>(reg.lineal<span class="sc">$</span>residuals)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>std<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(reg.lineal<span class="sc">$</span>residuals))</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dnorm</span>(x, <span class="at">mean=</span>m, <span class="at">sd=</span>std), <span class="at">col=</span><span class="st">"darkblue"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">add=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="reg-lineal_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p><em>No es necesario hacer las tres opciones, sino que con elegir una es suficiente.</em></p>
<ol start="3" type="1">
<li><strong>Homocedasticidad</strong>.</li>
</ol>
<!-- -->
<ol type="i">
<li>Este supuesto puede comprobarse examinando el diagrama de scale-location. El gráfico muestra si los residuos se distribuyen equitativamente a lo largo de los rangos de las variables independientes. Deberíamos de observar una línea horizonal, sin fuertes tendencias.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg.lineal, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="reg-lineal_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<ol start="2" type="i">
<li>Para tener un resultado más concluyente, hacemos un test de heterocedasticidad. La Ho en este test es que la varianza de los residuos es constante (homocedástica, lo que queremos). La evidencia no permite rechazar la hipótesis nula, por lo cual afirmamos que la distribución es homocedástica.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(lmtest)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(reg.lineal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  reg.lineal
BP = 1.5496, df = 1, p-value = 0.2132</code></pre>
</div>
</div>
<p><em>Para este supuesto es mejor el test que la imágen (más dificil de interpretar)</em></p>
<ol start="4" type="1">
<li><strong>Independencia de los residuos</strong> Durbin Watson permite examinar si los residuos se autocorrelacionan con ellos mismos. La Ho en este test es que no están autocorrelacionados (lo que queremos). Esta prueba podría ser especialmente útil cuando tenemos series temporales (correlación serial, encuestas tipo panel). Por ejemplo, esta prueba podría decirte si los residuos en el momento T1 están correlacionados con los residuos en el momento T2 (no deberían estarlo). En los datos de sección cruzada es menos común, aunque posible (correlación espacial).</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(car)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">durbinWatsonTest</span>(reg.lineal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> lag Autocorrelation D-W Statistic p-value
   1        0.151464      1.682134   0.096
 Alternative hypothesis: rho != 0</code></pre>
</div>
</div>
<p>p-value&gt;0.5. No podemos rechazar la Ho, lo que indica que los errores no están autocorrelacionados (lo que queremos).</p>
<ol start="5" type="1">
<li><strong>Multicolinealidad</strong>. Hace referencia a la correlación entre las VIs. Podemos medir la existencia de multicolinealidad usado el <strong>VIF</strong> (Variation Inflation Factor). Si el valor está por debajo de 5 está bien, no hay multicolinealidad. Por encima, si no sobrepasa demasiado esta cifra, y las variables que correlacionan son importantes para el análisis que se quiere realizar, se puede aceptar este supuesto aunque la multicolinealidad sea superior a 5.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(rms)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(reg.lineal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>gdp 
  1 </code></pre>
</div>
</div>
<p><strong>Hacer los test a la vez</strong></p>
<ol type="1">
<li>Con la función <code>plot()</code> de R base para obtener todos los gráficos de manera conjunta.</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg.lineal, <span class="at">pch=</span><span class="dv">23</span> ,<span class="at">bg=</span><span class="st">'red'</span>, <span class="at">cex=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="reg-lineal_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
<p>Hemos visto arriba cómo interpretar gráficos 1-3. El gráfico inferior-derecha nos ayuda a detectar casos influyentes. <strong>Leverage</strong> es una medida de cuánta influencia ejerce cada punto la recta de regresión. No todos los valores atípicos son influyentes en el análisis de regresión lineal. Al contrario, se puede dar el caso de que haya valores extremos que no son determinantes a la hora de estima la recta de gresión, por lo que los resultados no serían muy diferentes si los excluímos del análisis. Sin embargo, si los casos están fuera de la <em>distancia de Cook</em> (lo que significa que tienen puntuaciones de distancia de Cook altas), los resultados de la regresión se alterarán si excluimos esos casos. Para un buen modelo de regresión, la línea suavizada roja debe permanecer cerca de la línea media y ningún punto debe tener una distancia de Cook grande. Si queremos identificar esos puntos en concreto (son los que se indican con un *):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">influence.measures</span>(reg.lineal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Influence measures of
     lm(formula = cpi ~ gdp, data = datos_reg) :

       dfb.1_   dfb.gdp     dffit cov.r   cook.d     hat inf
2   -4.80e-02  0.024368 -5.18e-02 1.026 1.35e-03 0.01167    
3    4.81e-02 -0.029947  4.94e-02 1.030 1.23e-03 0.01438    
5   -6.26e-02  0.044437 -6.29e-02 1.034 1.99e-03 0.01817    
7   -1.05e-01  0.015211 -1.46e-01 0.985 1.06e-02 0.00919    
8   -6.88e-02 -0.008246 -1.17e-01 1.000 6.87e-03 0.00914    
9   -1.20e-02  0.027132  3.04e-02 1.065 4.68e-04 0.04418   *
10   5.16e-02 -0.126716 -1.45e-01 1.048 1.06e-02 0.03792    
12   1.36e-01 -0.072942  1.44e-01 1.000 1.03e-02 0.01223    
13   2.22e-05 -0.000016  2.22e-05 1.038 2.49e-10 0.01891    
14  -5.75e-02 -0.006348 -9.75e-02 1.009 4.75e-03 0.00913    
16   1.25e-03 -0.003170 -3.67e-03 1.057 6.80e-06 0.03580   *
18   3.75e-02 -0.024186  3.82e-02 1.033 7.35e-04 0.01518    
19   6.45e-02 -0.033373  6.92e-02 1.023 2.41e-03 0.01185    
21   2.45e-02 -0.009383  2.86e-02 1.028 4.13e-04 0.01019    
25  -1.72e-02  0.002221 -2.43e-02 1.027 2.99e-04 0.00917    
26  -1.29e-01  0.078765 -1.33e-01 1.010 8.77e-03 0.01405    
28  -6.33e-02 -0.117466 -2.67e-01 0.920 3.39e-02 0.01128   *
29  -1.20e-01  0.080819 -1.21e-01 1.019 7.36e-03 0.01636    
30  -2.45e-02  0.017800 -2.46e-02 1.038 3.04e-04 0.01914    
31  -2.20e-02  0.051373  5.82e-02 1.061 1.71e-03 0.04140   *
34   1.15e-02 -0.005865  1.24e-02 1.031 7.81e-05 0.01169    
36   3.87e-02  0.082522  1.79e-01 0.980 1.58e-02 0.01154    
37  -1.21e-02  0.003088 -1.54e-02 1.028 1.20e-04 0.00947    
38   8.58e-02 -0.222098 -2.58e-01 1.020 3.31e-02 0.03479    
39  -2.93e-02  0.010693 -3.47e-02 1.027 6.06e-04 0.01005    
42  -4.08e-02  0.030954 -4.08e-02 1.040 8.39e-04 0.02143    
43   8.66e-02 -0.022573  1.10e-01 1.005 6.08e-03 0.00949    
44   1.44e-02  0.000463  2.30e-02 1.027 2.68e-04 0.00909    
47  -1.36e-02 -0.018070 -4.65e-02 1.026 1.09e-03 0.01071    
49  -1.04e-01  0.264626  3.07e-01 1.008 4.63e-02 0.03563    
52  -1.63e-03  0.000863 -1.73e-03 1.031 1.52e-06 0.01208    
55   9.41e-02 -0.069173  9.42e-02 1.031 4.46e-03 0.01973    
57  -6.04e-03  0.028439  3.76e-02 1.040 7.14e-04 0.02122    
59  -9.07e-02  0.234781  2.73e-01 1.016 3.69e-02 0.03478    
60  -1.39e-03  0.004254  5.16e-03 1.049 1.34e-05 0.02839    
63   1.05e-01 -0.046799  1.17e-01 1.006 6.88e-03 0.01081    
65  -3.47e-02  0.117655  1.46e-01 1.030 1.07e-02 0.02581    
66   2.32e-01 -0.161852  2.34e-01 0.980 2.68e-02 0.01746    
68  -2.54e-02 -0.094179 -1.79e-01 0.985 1.58e-02 0.01257    
70  -5.22e-02  0.029655 -5.46e-02 1.028 1.50e-03 0.01289    
75   8.46e-02 -0.018178  1.12e-01 1.003 6.22e-03 0.00934    
77   5.23e-02 -0.032886  5.35e-02 1.030 1.44e-03 0.01463    
79  -1.18e-01  0.049841 -1.34e-01 0.998 8.97e-03 0.01054    
80  -1.57e-01  0.111283 -1.58e-01 1.012 1.24e-02 0.01815    
81  -7.43e-04  0.002142  2.56e-03 1.050 3.31e-06 0.03019    
82   1.15e-02 -0.052365 -6.88e-02 1.037 2.39e-03 0.02158    
84   2.43e-03 -0.001763  2.44e-03 1.039 2.99e-06 0.01910    
85   6.81e-02 -0.042009  7.00e-02 1.027 2.47e-03 0.01421    
86  -1.15e-02  0.033553  4.02e-02 1.049 8.16e-04 0.02992    
87  -1.07e-01 -0.042074 -2.21e-01 0.937 2.35e-02 0.00943   *
88   8.25e-02 -0.040203  9.00e-02 1.017 4.06e-03 0.01136    
89   4.05e-03 -0.002945  4.06e-03 1.039 8.30e-06 0.01923    
91   7.80e-02 -0.232423 -2.80e-01 1.000 3.87e-02 0.02913    
92  -2.90e-02 -0.024579 -7.87e-02 1.018 3.11e-03 0.01007    
93  -8.00e-02  0.052025 -8.13e-02 1.027 3.32e-03 0.01540    
97   1.22e-02  0.007756  2.94e-02 1.027 4.37e-04 0.00977    
101  4.35e-02  0.013714  8.54e-02 1.014 3.65e-03 0.00933    
103  3.26e-02 -0.024281  3.26e-02 1.039 5.37e-04 0.02037    
104  1.59e-01 -0.118003  1.59e-01 1.016 1.26e-02 0.02023    
105  2.22e-02  0.001854  3.69e-02 1.025 6.85e-04 0.00911    
107  2.03e-02 -0.014865  2.04e-02 1.039 2.10e-04 0.01943    
111 -5.39e-02  0.015849 -6.70e-02 1.020 2.25e-03 0.00963    
114  1.97e-02 -0.011571  2.05e-02 1.032 2.12e-04 0.01335    
115  3.18e-02 -0.010734  3.83e-02 1.026 7.39e-04 0.00987    
116  4.49e-02 -0.026687  4.66e-02 1.030 1.09e-03 0.01354    
117  1.36e-03 -0.000908  1.38e-03 1.035 9.60e-07 0.01604    
118  8.97e-03  0.000233  1.43e-02 1.028 1.03e-04 0.00909    
122 -4.47e-02  0.108235  1.24e-01 1.052 7.70e-03 0.03875    
124 -5.86e-02  0.288122  3.84e-01 0.918 6.98e-02 0.02084   *
126  1.24e-01 -0.093081  1.24e-01 1.026 7.73e-03 0.02076    
127 -4.31e-02  0.030073 -4.33e-02 1.035 9.45e-04 0.01756    
128 -1.32e-02  0.027227  2.98e-02 1.078 4.47e-04 0.05559   *
132 -2.04e-02  0.013686 -2.06e-02 1.035 2.14e-04 0.01628    
136  1.21e-02 -0.005783  1.33e-02 1.030 8.90e-05 0.01122    
137  6.27e-02 -0.040580  6.38e-02 1.029 2.05e-03 0.01526    
138  6.35e-02  0.015654  1.19e-01 1.000 7.02e-03 0.00925    
139  1.33e-02  0.036739  7.44e-02 1.022 2.78e-03 0.01202    
142  6.58e-02  0.051678  1.72e-01 0.975 1.46e-02 0.00999    
143  9.18e-02 -0.051045  9.66e-02 1.018 4.68e-03 0.01261    
144 -1.05e-01  0.017975 -1.43e-01 0.987 1.01e-02 0.00924    
151 -1.68e-03 -0.000181 -2.85e-03 1.028 4.09e-06 0.00913    
152  1.82e-01 -0.130145  1.83e-01 1.004 1.66e-02 0.01838    
153  1.53e-02 -0.005150  1.85e-02 1.028 1.72e-04 0.00986    
156  1.24e-02 -0.024756 -2.68e-02 1.085 3.63e-04 0.06108   *
157 -1.62e-02 -0.018856 -5.14e-02 1.025 1.33e-03 0.01050    
158 -2.32e-03  0.001476 -2.36e-03 1.034 2.82e-06 0.01490    
159  5.01e-03 -0.047260 -6.79e-02 1.032 2.32e-03 0.01763    
162 -6.86e-02  0.050899 -6.87e-02 1.035 2.37e-03 0.02018    
163  4.94e-04 -0.013027 -1.97e-02 1.035 1.97e-04 0.01611    
168 -8.21e-02  0.188530  2.12e-01 1.045 2.25e-02 0.04296    
169 -5.23e-02  0.121760  1.38e-01 1.055 9.52e-03 0.04179    
170 -1.90e-01  0.050467 -2.41e-01 0.922 2.77e-02 0.00951   *
171 -7.74e-02  0.054745 -7.77e-02 1.031 3.04e-03 0.01803    
172 -6.00e-02  0.003478 -8.95e-02 1.012 4.01e-03 0.00910    
176  3.65e-02  0.071512  1.59e-01 0.989 1.26e-02 0.01138    
177  2.67e-02 -0.011426  3.02e-02 1.028 4.59e-04 0.01061    
179 -1.83e-01  0.104072 -1.91e-01 0.980 1.80e-02 0.01292    
181 -1.02e-02  0.007416 -1.02e-02 1.039 5.27e-05 0.01919    
182 -9.63e-02  0.054330 -1.01e-01 1.017 5.11e-03 0.01279    
183  5.95e-02 -0.026691  6.65e-02 1.022 2.22e-03 0.01084    
184 -1.59e-02  0.009246 -1.66e-02 1.032 1.39e-04 0.01317    
185 -2.22e-03  0.005559  6.41e-03 1.058 2.07e-05 0.03666   *
186  9.89e-02 -0.073192  9.90e-02 1.030 4.92e-03 0.02005    
187  2.32e-01 -0.447094 -4.80e-01 1.034 1.13e-01 0.06919   *
188  1.52e-01 -0.110254  1.53e-01 1.016 1.16e-02 0.01901    
189  1.07e-01  0.052107  2.35e-01 0.927 2.65e-02 0.00956   *
190 -1.92e-01  0.087686 -2.13e-01 0.956 2.20e-02 0.01095    
191 -1.54e-01 -0.005725 -2.47e-01 0.911 2.90e-02 0.00910   *
193 -1.57e-01  0.100145 -1.60e-01 1.003 1.27e-02 0.01500    
194  1.70e-01 -0.126161  1.71e-01 1.013 1.45e-02 0.02007    </code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Gloval Validation of Linear Models Assumptions (paquete <code>gvlma</code>).</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(gvlma)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>gvlma<span class="sc">::</span><span class="fu">gvlma</span>(reg.lineal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = cpi ~ gdp, data = datos_reg)

Coefficients:
(Intercept)          gdp  
  24.237839     0.002163  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma::gvlma(x = reg.lineal) 

                    Value p-value                Decision
Global Stat        5.2691 0.26078 Assumptions acceptable.
Skewness           1.2784 0.25819 Assumptions acceptable.
Kurtosis           0.1015 0.75004 Assumptions acceptable.
Link Function      0.4845 0.48641 Assumptions acceptable.
Heteroscedasticity 3.4047 0.06501 Assumptions acceptable.</code></pre>
</div>
</div>
<p>Concretamente:</p>
<ul>
<li><strong>Global Stat</strong> mide si relación entre las VIs y la VD es realmente lineal. El rechazo de la Ho indica que la relación no es lineal.</li>
<li><strong>Skewness</strong> mide si la distribución está sesgada y necesita una transformación para cumplir con el supuesto de normalidad. El rechazo de la Ho indica que los datos deberían ser transformados.</li>
<li><strong>Kurtosis</strong> mide si la distribución es leptocúrtica o platicúrtica. El rechazo de la Ho indica que los datos deberían ser transformados.</li>
<li><strong>Link Function</strong> indica si la variable dependiente es realmente continua o es categórica. El rechazo de la Ho indica que sería conveniente usar un modelo alternativo de regresión, como el logístico o la regresión binomial.</li>
<li><strong>Heteroscedasticity</strong> mide el supuesto de homocedasticidad. El rechazo de la Ho indica que los residuos son heterocedásticos, y que el modelo precide unos rangos de la variable dependiente mejor que otros.</li>
</ul>
<p><em>En la práctica, lo importante es mirar los siguientes supuetos: multicolinealidad (sobre todo esta, porque se puede ver a simple vista si sabes del tema) y homocedasticidad.</em></p>
</section>
<section id="exportar-resultados" class="level3">
<h3 class="anchored" data-anchor-id="exportar-resultados">Exportar los resultados</h3>
<p>Esta librería cuenta con numerosas opciones para modificar la tabla con los resultados (<code>?stargazer</code>)</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(stargazer)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(reg.lineal,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">type=</span><span class="st">"text"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">dep.var.labels=</span><span class="fu">c</span>(<span class="st">"Corruption Perception Index"</span>),</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">covariate.labels=</span><span class="fu">c</span>(<span class="st">"GDP"</span>,<span class="st">"cte"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                    Corruption Perception Index
-----------------------------------------------
GDP                          0.002***          
                             (0.0001)          
                                               
cte                          24.238***         
                              (1.521)          
                                               
-----------------------------------------------
Observations                    110            
R2                             0.749           
Adjusted R2                    0.747           
Residual Std. Error      10.225 (df = 108)     
F Statistic          322.340*** (df = 1; 108)  
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="teoría" class="level2">
<h2 class="anchored" data-anchor-id="teoría">Teoría</h2>
<section id="objetivos" class="level3">
<h3 class="anchored" data-anchor-id="objetivos">Objetivos:</h3>
<ul>
<li><strong>Estimar/predecir</strong> los valores que adoptará la variable dependiente (VD) a partir de valores conocidos del conjunto de variables independientes (VIs).</li>
<li><strong>Cuantificar</strong> la relación de dependencia. Es decir, determinar qué proporción de varianza de la VD queda explicada por la suma de VIs.</li>
<li><strong>Determinar el grado de confianza</strong> con que se puede afirmar que la relación observada en los datos muestras se da en la población.</li>
</ul>
</section>
<section id="regresión-lineal-simple" class="level3">
<h3 class="anchored" data-anchor-id="regresión-lineal-simple">Regresión lineal simple</h3>
<p>Cuando hacemos una regresión lineal modelamos una variable continua <strong>y</strong> como una función matemática de una o más variables <strong>xi</strong>, de manera que podamos usar ese modelo de regresión para predecir <strong>y</strong> cuando solo conozcamos <strong>xi</strong>. Hablamos de regresión simple cuando sólo están involucradas dos variables. En este caso, la ecuación de regresión se puede generalizar de la siguiente manera:</p>
<ul>
<li>Fórmula matemática:</li>
</ul>
<p><span class="math display">\[y = \beta_1 + \beta_2 x\]</span></p>
<ul>
<li>Fórmula regresiva:</li>
</ul>
<p><span class="math display">\[\hat{y} = \hat{\beta}_1 + \hat{\beta}_2 + u\]</span> donde <strong>β1</strong> es la ordenada en el origen (o lo que es lo mismo, el valor de y cuando xi = 0) y <strong>β2</strong> es la pendiente de la recta. En conjunto, se denominan coeficientes de regresión. El término u es el término de error, es decir, la parte de variable dependiente que el modelo de regresión no puede explicar. Gráficamente:</p>
<center>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="01_img/explicacion_regresion.png" class="img-fluid figure-img" width="320"></p>
<figcaption>Intervalos de confianza</figcaption>
</figure>
</div>
</center>
</section>
<section id="mínimos-cuadrados-ordinarios-mco" class="level3">
<h3 class="anchored" data-anchor-id="mínimos-cuadrados-ordinarios-mco">Mínimos Cuadrados Ordinarios (MCO)</h3>
<p>Mediante la regresión lineal de una variable y sobre una variable x, buscamos una función que sea una aproximación de una nube de puntos (x<sub>i</sub>, y<sub>i</sub>). Por una nube de puntos, sin embargo, pasan infinitas rectas. Para conocer cuál es la más adecuada, se emplea el método de MCO (OLS en inglés) para estimar los parámetros del modelo (<em>β<sub>i</sub></em>).El método de los mínimos cuadrados se utiliza para calcular la recta de regresión lineal que minimiza los residuos, esto es, las diferencias entre los valores reales observados (yi) y los valores estimados por la recta (<sub>i</sub>).</p>
</section>
<section id="bondad-de-ajuste-del-modelo" class="level3">
<h3 class="anchored" data-anchor-id="bondad-de-ajuste-del-modelo">Bondad de ajuste del modelo</h3>
<p>El método de mínimos cuadrados selecciona la línea que más se ajusta a nuestras observaciones. Sin embargo, que esa recta sea la mejor, no quiere decir que sea necesariamente buena. Para determinar la bondad de ajuste de nuestro modelo vamos a utilizar el Coeficiente de Determinación R<sup>2</sup>.</p>
<p>El coeficiente de determinación explica cuánta varianza de la variable dependiente podemos explicar con nuestro modelo. Su valor puede oscilar entre 0 y 1. Cuanto mayor sea su valor, más preciso será el modelo de regresión. A menudo se interpreta como un porcentaje.</p>
</section>
<section id="supuestos-de-la-regresión" class="level3">
<h3 class="anchored" data-anchor-id="supuestos-de-la-regresión">Supuestos de la regresión</h3>
<p>Para ver si un modelo de regresión lineal ajustado es valido, debemos comprobar que se cumplen estas tres condiciones sobre los residuos:</p>
<ol type="1">
<li>Independencia: los residuos deben ser independientes entre sí</li>
<li>Homocedasticidad: para cada valor de la variable x, la varianza de los residuos ei debe ser la misma (es decir, que el ajuste es igual de preciso independientemente de los valores que tome x).</li>
<li>Normalidad: para cada valor de la variable independiente x, los residuos ei se distribuyen normalmente con media 0.</li>
</ol>
<p>Además:</p>
<ol start="4" type="1">
<li>La relación entre las variables x e y es lineal.</li>
<li>Ausencia de multicolinealidad (dos de las variables independientes están muy correlacionadas, una explica la otra).</li>
</ol>
<hr>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="jorgeemm/Pagina_R" data-repo-id="R_kgDONhBVEg" data-category="General" data-category-id="DIC_kwDONhBVEs4Clcdh" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="es" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark_dimmed">
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../analisis/tablas-contingencia.html" class="pagination-link" aria-label="Tablas de contingencia">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Tablas de contingencia</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../analisis/reg-multiple.html" class="pagination-link" aria-label="Lineal múltiple">
        <span class="nav-page-text">Lineal múltiple</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>